<!DOCTYPE html>
<html ng-app="zombieApp">
  <head>
    <title>Incremancer</title>
    <meta name="description" content="Zombie necromancer idle game">
    <meta name="keywords" content="zombie,game,idle,javascript">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="manifest.json">
    <!-- <script src="js/pixi.min.js"></script> -->
    <script src="js/pixi-legacy.min.js"></script>
    <script src="js/utilsfunctions.js"></script>
    <script src="js/zombiemancer.js"></script>
    <script src="js/map.js"></script>
    <script src="js/gamemodel.js"></script>
    <script src="js/upgrades.js"></script>
    <script src="js/humans.js"></script>
    <script src="js/zombies.js"></script>
    <script src="js/graveyard.js"></script>
    <script src="js/particles.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/angularzombie.js"></script>
    <link rel="stylesheet" type="text/css" href="zombiemancer.css">
  </head>
  <body ng-controller="ZombieController as zm">
    <div class="top-bar">
      <div class="resources">
          <label class="energy">Energy: {{zm.model.energy|decimal}} / {{zm.model.energyMax|whole}}</label>
          <label class="blood">Blood: {{zm.model.persistentData.blood|whole}} / {{zm.model.bloodMax|whole}}</label>
          <label class="brains">Brains: {{zm.model.persistentData.brains|whole}} / {{zm.model.brainsMax|whole}}</label>
          <label class="bones" ng-if="zm.model.graveyard">Bones: {{zm.model.persistentData.bones|whole}}</label>
      </div>
      <div class="stats">
        <label>Level: {{zm.model.level}}</label>
        <label>Humans: {{zm.model.getHumanCount()}}</label>
        <label>Zombies: {{zm.model.zombieCount}}</label>
        <label ng-if="zm.model.showfps">FPS: {{zm.model.frameRate}}</label>
      </div>
    </div>

    <div class="buttons">
      <button ng-click="zm.toggleShop();">Shop</button>
      <button ng-click="zm.toggleGraveyard();" ng-if="zm.model.graveyard" class="graveyard">Graveyard</button>
      <button ng-click="zm.toggleOptions();" class="options">Options</button>
    </div>

    <div class="zoom-buttons" ng-if="zm.model.persistentData.zoomButtons">
      <button ng-click="zm.zoom(-1);">-</button>
      <button ng-click="zm.resetZoom();">Reset</button>
      <button ng-click="zm.zoom(+1);">+</button>
    </div>

    <div class="shop" ng-if="zm.shopOpen">
      <div class="shop-title">
        <h2>Shop</h2>
        <button ng-click="zm.toggleShop();">Close</button>
      </div>

      <div class="tabs">
        <h3>What would you like to pay with?</h3>
        <button ng-click="zm.filterShop('blood');" class="blood {{zm.currentShopFilter == 'blood' ? 'active' : ''}}">Blood</button>
        <button ng-click="zm.filterShop('brains');" class="brains {{zm.currentShopFilter == 'brains' ? 'active' : ''}}">Brains</button>
        <button ng-click="zm.filterShop('bones');" class="bones {{zm.currentShopFilter == 'bones' ? 'active' : ''}}" ng-if="zm.model.graveyard">Bones</button>
      </div>

      <div class="upgrades">
        <div ng-repeat="upgrade in zm.upgrades" class="upgrade {{upgrade.costType}}" ng-if="zm.upgradeVisible(upgrade);">
          <h4>{{upgrade.name}}</h4>
          <label>{{zm.upgradeSubtitle(upgrade)}}</label>
          <p>{{upgrade.description}}</p>
          <label>Cost: {{zm.upgradePrice(upgrade)|whole}} {{upgrade.costType}}</label>
          <p>Current Rank: {{zm.currentRank(upgrade)}} / {{upgrade.cap}} - {{zm.upgradeStatInfo(upgrade)}}</p>
          <button ng-click="zm.buyUpgrade(upgrade);" ng-disabled="zm.upgradeTooExpensive(upgrade);">{{zm.currentRank(upgrade) >= upgrade.cap ? 'Sold Out' : zm.upgradeTooExpensive(upgrade) ? zm.requiredForUpgrade(upgrade) : zm.purchaseText(upgrade)}}</button>
        </div>
      </div>
    </div>

    <div class="shop" ng-if="zm.graveyardOpen">
      <div class="shop-title">
        <h2>Cursed Graveyard</h2>
        <button ng-click="zm.toggleGraveyard();">Close</button>
      </div>
      <div class="upgrades">
        <div class="bone-collectors bones">
          <h4>Bone Collectors</h4>
          <p>Hire bone collectors to gather bones from the town's dead and your own fallen zombies. Each bone collector consumes 1 energy per second. They're hungry little creatures. Must be all that running around.</p>
          <h4>Energy rate {{zm.model.getEnergyRate()|decimal}} per second</h4>
          <button ng-click="zm.subtractBoneCollector();">-</button><label>{{zm.model.persistentData.boneCollectors|whole}} bone collectors</label><button ng-click="zm.addBoneCollector();">+</button>
        </div>
        <div class="bone-collectors bones">
          <h4>Zombies to Spawn</h4>
          <p>Control how many zombies the graveyard spawns each time your energy is full. This is limited by your maximum energy.</p>
          <button ng-click="zm.subtractGraveyardZombie();">-</button><label>{{zm.model.persistentData.graveyardZombies|whole}} zombies</label><button ng-click="zm.addGraveyardZombie();">+</button>
        </div>
      </div>
    </div>

    <div class="shop" ng-if="zm.optionsOpen">
      <div class="shop-title">
        <h2>Options</h2>
        <button ng-click="zm.toggleOptions();">Close</button>
      </div>
      <div class="upgrades">
        <div class="upgrade">
          <h4>How to play</h4>
          <ul>
            <li ng-repeat="text in zm.howToPlay">{{text}}</li>
          </ul>
        </div>
        <div class="upgrade">
          <h4>Auto Start Next Level</h4>
          <p>Automatically start the next level after 3 seconds. If you want to play without actually playing.</p>
          <button ng-click="zm.toggleAutoStart();">{{zm.model.persistentData.autoStart ? "On" : "Off"}}</button>
        </div>
        <div class="upgrade">
          <h4>Render Resolution</h4>
          <p>Choose your preferred resolution to render the game.</p>
          <p>50% will run better on slower harder but may look blurry.</p>
          <p>100% will pixel match the resolution reported by your browser.</p>
          <p>200% will double the reported values which may look better on retina devices or smartphones.</p>
          <button ng-click="zm.toggleResolution(0.5);" class="{{zm.getResolution() == 0.5 ? 'active' : ''}}">50%</button>
          <button ng-click="zm.toggleResolution(1);" class="{{zm.getResolution() == 1 ? 'active' : ''}}">100%</button>
          <button ng-click="zm.toggleResolution(2);" class="{{zm.getResolution() == 2 ? 'active' : ''}}">200%</button>
        </div>
        <div class="upgrade" ng-if="zm.model.deferredPrompt">
          <h4>Add to Home Screen</h4>
          <p>You can add this game to your smartphones home screen without having to install anything.</p>
          <button ng-click="zm.addToHomeScreen();">Add to Home Screen</button>
        </div>
        <div class="upgrade">
          <h4>Show Zoom Buttons</h4>
          <p>If you're unable to zoom with other methods this will add some buttons to the screen for zooming the map.</p>
          <button ng-click="zm.toggleZoomButtons();">{{zm.model.persistentData.zoomButtons ? "On" : "Off"}}</button>
        </div>
        <div class="upgrade">
          <h4>Show Framerate Counter</h4>
          <p>Used for performance testing</p>
          <button ng-click="zm.toggleShowFps();">{{zm.model.showfps ? "On" : "Off"}}</button>
        </div>
        <div class="upgrade">
          <h4>Reset Game</h4>
          <p>This will reset all save data if you want to start from the very beginning again.</p>
          <button ng-click="zm.resetGame();">Reset Game</button>
        </div>
      </div>
    </div>

    <div class="start-game" ng-if="zm.model.currentState == zm.model.states.startGame">
      <h2>Incremancer</h2>
      <h4>Take control of a horde of zombies to ravage small towns</h4>
      <ul>
        <li ng-repeat="text in zm.howToPlay">{{text}}</li>
      </ul>
      <button ng-click="zm.startGame();">Start Game</button>
    </div>
    <div class="end-level" ng-if="zm.model.currentState == zm.model.states.levelCompleted">
      <h2>Level {{zm.model.level}} Complete</h2>
      <h4>All the humans are either dead or undead!</h4>
      <button ng-click="zm.nextLevel();">Start Level {{zm.model.level + 1}}</button>
    </div>
  </body>
</html>